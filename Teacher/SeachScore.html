<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>    <meta charset="utf-8">    <title>班级成绩</title>    <script type="text/javascript" src="../js/echarts.js"></script>    <script type="text/javascript" src="../js/jquery.min.js"></script>    <script type="text/javascript" src="../js/datetime.js"></script>    <script type="text/javascript" src="../js/laydate/laydate.js"></script>    <!-- Bootstrap core CSS -->    <link href="../css/bootstrap.min.css" rel="stylesheet">    <script>        laydate.render({            elem: '#starttime'        });        laydate.render({            elem: '#endtime'        });    </script></head><body><div style="position:relative;overflow:hidden;width:1538px;height:760px;padding:0px;border-width:0px;cursor:default;"/><div id="bar" style="height:400px;width: 1200px;"></div><form action="#" method="post" id="form1" onsubmit="return false">    <fieldset>        <div class="row">            <div class="col-md-3">                <label >起始时间:</label>                <input type="text" id="starttime" name="starttime">            </div>            <div class="col-md-3">                <label >终止时间:</label>                <input type="text" id="endtime" name="endtime">            </div>            <div class="col-md-3">                <input type="submit" class="btn" value="数据分析" name="btn" onclick="tijiao()">                <!--                <div class="col-md-1">                <input type="submit" class="btn" value="提交" name="btn" onclick="tijiao()">                </div>                <div class="col-md-1">                <input type="submit" class="btn" value="方差计算" name="btn" onclick="dv()">                </div>                <div class="col-md-1">                </div>                -->            </div>        </div>    </fieldset>    <p><div id="success"></div></p></form><script type="text/javascript">    //var myChart=echarts.init(document.getElementById('bar'));    var myChart = echarts.init(document.getElementById('bar'));    var studentno=[],sname=[],cname=[],score=[],time=[];    function arrTest(){        //读取json数据        $.ajax({            type:"post",        //请求服务器载入数据            async:false,           //异步属性            url:"bar.php",            data:{},            dataType:"json",            success:function(result1){                if(result1){                    studentno=[];                    sname=[];                    cname=[];                    score=[];                    time=[];                    for(var i=0;i<result1.length;i++){                        studentno.push(result1[i].sno);                        sname.push(result1[i].name);                        cname.push(result1[i].cname);                        score.push(result1[i].score);                        time.push(result1[i].time);                    }                }            }        });      // alert("ajax刷新数据");        return studentno,sname,cname,score,time;    }    //通过提交表单的形式，重新绘制图像    function cricle(){        //通过ajax的方式提交数据，在后台通过sql查询重新修改数据集        //在ajax的数据成功返回的地方重新调用图像绘制函数      //  var endtime=document.getElementById('test2').value();        var starttime=document.getElementById('starttime').value;        var endtime=document.getElementById('endtime').value;        $.ajax({            type:"POST",        //方法            async:false,            url:"SearchScore.php",             //表单接受url            data:{                'starttime':starttime,                'endtime':endtime            },            datatype:"json",            success:function(result){                //提交成功               // alert("提交成功!");                studentno=[];                sname=[];                cname=[];                score=[];                time=[];                var obj;                //检查json数据返回是否是对象类型                if((typeof result=='object')&&result.constructor==Object){                    obj=result;                }else{                        //如果json数据是字符串类型，进行转换                    obj=eval("("+result+")");                }                //获取json数据                if(obj){                    for(var i=0;i<obj.length;i++){                        studentno.push(obj[i].sno);                        sname.push(obj[i].name);                        cname.push(obj[i].cname);                        score.push(obj[i].score);                        time.push(obj[i].time);                    }                    // alert('ajax获取time'+time);                    // alert('ajax读取数据'+obj[0].time);                    // alert('ajax获取result结果值:'+obj);                    // alert('ajax获取result结果值:'+sname);                }            },            error:function(){                //提交失败               alert("提交失败!");            }        });        alert("提交表单,ajax刷新数据");        return time,studentno,sname,cname,score;    }    arrTest();    //进行图像绘制    //配置图像参数    var option={        title: {            text: '班级成绩折线图'        },        tooltip : {            trigger: 'axis',            axisPointer: {                type: 'cross',            }        },        legend: {            data:[cname[0]]        },        toolbox: {            feature: {                saveAsImage: {}            }        },        grid: {            left: '3%',            right: '4%',            bottom: '3%',            containLabel: true        },        xAxis : [            {                type : 'category',                boundaryGap : false,                data :time            }        ],        yAxis : [            {                type : 'value'            }        ],        series : [            {                name:cname[0],                type:'line',                stack: '总量',                data:score            },        ]    };    //绘画图像    myChart.setOption(option);    function tijiao(){        var array=cricle();        //进行图像绘制        //配置图像参数        var option={                title: {                    text: '班级成绩折线图'                },                tooltip : {                    trigger: 'axis',                    axisPointer: {                        type: 'cross',                    }                },                legend: {                    data:[cname[0]]                },                toolbox: {                    feature: {                        saveAsImage: {}                    }                },                grid: {                    left: '3%',                    right: '4%',                    bottom: '3%',                    containLabel: true                },                xAxis : [                    {                        type : 'category',                        boundaryGap : false,                        data :time                    }                ],                yAxis : [                    {                        type : 'value'                    }                ],                series : [                    {                        name:cname[0],                        type:'line',                        stack: '总量',                        data:score                    },                ]        };        //绘画图像        myChart.setOption(option);    }</script></body></html>